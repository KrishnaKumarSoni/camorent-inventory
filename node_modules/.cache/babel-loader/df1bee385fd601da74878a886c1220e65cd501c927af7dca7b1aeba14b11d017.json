{"ast":null,"code":"import React,{useState}from'react';import{useNavigate}from'react-router-dom';import{useAuth}from'../contexts/AuthContext';import{api}from'../utils/api';import VoiceRecorder from'../components/VoiceRecorder';import ProcessingModal from'../components/ProcessingModal';import EquipmentForm from'../components/EquipmentForm';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const AddItemPage=()=>{const[pageState,setPageState]=useState('recording');const[audioBlob,setAudioBlob]=useState(null);const[extractedData,setExtractedData]=useState(null);const[confidenceScores,setConfidenceScores]=useState(null);const[saving,setSaving]=useState(false);const navigate=useNavigate();const handleRecordingComplete=blob=>{setAudioBlob(blob);setPageState('processing');};const handleProcessingComplete=result=>{console.log('Processing complete, result:',result);setExtractedData(result.formData||result);setConfidenceScores(result.confidenceScores);setPageState('form');};const handleProcessingCancel=()=>{setPageState('recording');setAudioBlob(null);setExtractedData(null);setConfidenceScores(null);};const handleFormSubmit=async formData=>{setSaving(true);try{const{user}=useAuth();if(!user){throw new Error('User not authenticated');}// Save to Firebase via API endpoint\nconst response=await api.createInventoryItem({...formData,created_by:user.uid});if(!response.success){throw new Error(response.error||'Failed to save equipment');}console.log('Equipment saved successfully:',response.data);// Navigate to inventory page after successful save\nnavigate('/inventory');}catch(error){console.error('Error saving equipment:',error);alert('Failed to save equipment. Please try again.');}finally{setSaving(false);}};const handleFormCancel=()=>{setPageState('recording');setAudioBlob(null);setExtractedData(null);setConfidenceScores(null);};if(pageState==='form'){console.log('Rendering form with data:',extractedData,'confidence:',confidenceScores);return/*#__PURE__*/_jsxs(\"div\",{className:\"p-6\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"text-center mb-8\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"font-heading font-bold text-primary text-2xl mb-2\",children:\"Review & Save Equipment\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-medium\",children:\"Verify details and add to digital inventory\"})]}),/*#__PURE__*/_jsx(EquipmentForm,{initialData:extractedData,confidenceScores:confidenceScores,onSubmit:handleFormSubmit,onCancel:handleFormCancel,loading:saving})]});}return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"div\",{style:{padding:'0',minHeight:'400px'},children:[/*#__PURE__*/_jsxs(\"div\",{style:{textAlign:'center',marginBottom:'40px'},children:[/*#__PURE__*/_jsx(\"h2\",{style:{fontSize:'28px',fontWeight:'700',color:'#1f2937',marginBottom:'12px',lineHeight:'1.2'},children:\"Add New Item\"}),/*#__PURE__*/_jsx(\"p\",{style:{color:'#6b7280',fontSize:'16px',lineHeight:'1.5',margin:'0 0 20px 0'},children:\"Record equipment details to add to your inventory\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>{const sampleText=\"This is a Canon camera, the R5 model I think. Got it from some dealer last year. Condition looks good, working fine but has some scratches on the body. Don't know the exact serial number... will check later. We keep it somewhere in the back warehouse. Pretty expensive camera, should rent for good money.\";console.log('Using sample text:',sampleText);// Create a mock audio blob with the sample text\nconst blob=new Blob([sampleText],{type:'audio/webm'});setAudioBlob(blob);setPageState('processing');},style:{backgroundColor:'#f3f4f6',border:'1px solid #d1d5db',borderRadius:'8px',padding:'8px 16px',fontSize:'14px',color:'#374151',cursor:'pointer',marginBottom:'20px'},children:\"\\uD83E\\uDDEA Use Sample Data (for testing)\"}),/*#__PURE__*/_jsxs(\"div\",{style:{textAlign:'left',marginBottom:'20px'},children:[/*#__PURE__*/_jsx(\"p\",{style:{fontSize:'14px',fontWeight:'600',color:'#374151',marginBottom:'8px'},children:\"\\uD83D\\uDCA1 What to mention when recording:\"}),/*#__PURE__*/_jsx(\"div\",{style:{display:'flex',flexWrap:'wrap',gap:'8px',justifyContent:'center'},children:['Equipment name & brand','Model number','Serial number','Condition','Purchase price','Current value','Daily rate','Storage location','Any issues or notes'].map((prompt,index)=>/*#__PURE__*/_jsx(\"span\",{style:{backgroundColor:'#fef3c7',color:'#92400e',padding:'4px 8px',borderRadius:'12px',fontSize:'12px',border:'1px solid #fbbf24'},children:prompt},index))})]})]}),/*#__PURE__*/_jsx(\"div\",{style:{backgroundColor:'#f8fafc',borderRadius:'24px',padding:'32px 24px',boxShadow:'0 4px 24px rgba(0, 0, 0, 0.06)',border:'1px solid #e2e8f0'},children:/*#__PURE__*/_jsx(VoiceRecorder,{onRecordingComplete:handleRecordingComplete,onCancel:()=>navigate('/inventory')})})]}),/*#__PURE__*/_jsx(ProcessingModal,{isOpen:pageState==='processing',onCancel:handleProcessingCancel,onComplete:handleProcessingComplete,audioBlob:audioBlob})]});};export default AddItemPage;","map":{"version":3,"names":["React","useState","useNavigate","useAuth","api","VoiceRecorder","ProcessingModal","EquipmentForm","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","AddItemPage","pageState","setPageState","audioBlob","setAudioBlob","extractedData","setExtractedData","confidenceScores","setConfidenceScores","saving","setSaving","navigate","handleRecordingComplete","blob","handleProcessingComplete","result","console","log","formData","handleProcessingCancel","handleFormSubmit","user","Error","response","createInventoryItem","created_by","uid","success","error","data","alert","handleFormCancel","className","children","initialData","onSubmit","onCancel","loading","style","padding","minHeight","textAlign","marginBottom","fontSize","fontWeight","color","lineHeight","margin","onClick","sampleText","Blob","type","backgroundColor","border","borderRadius","cursor","display","flexWrap","gap","justifyContent","map","prompt","index","boxShadow","onRecordingComplete","isOpen","onComplete"],"sources":["/Users/admin/Desktop/Dev/camorent-inventory/src/pages/AddItemPage.tsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport { useAuth } from '../contexts/AuthContext';\nimport { api } from '../utils/api';\nimport VoiceRecorder from '../components/VoiceRecorder';\nimport ProcessingModal from '../components/ProcessingModal';\nimport EquipmentForm from '../components/EquipmentForm';\n\ntype PageState = 'recording' | 'processing' | 'form';\n\nconst AddItemPage: React.FC = () => {\n  const [pageState, setPageState] = useState<PageState>('recording');\n  const [audioBlob, setAudioBlob] = useState<Blob | null>(null);\n  const [extractedData, setExtractedData] = useState<any>(null);\n  const [confidenceScores, setConfidenceScores] = useState<any>(null);\n  const [saving, setSaving] = useState(false);\n  const navigate = useNavigate();\n\n  const handleRecordingComplete = (blob: Blob) => {\n    setAudioBlob(blob);\n    setPageState('processing');\n  };\n\n  const handleProcessingComplete = (result: any) => {\n    console.log('Processing complete, result:', result);\n    setExtractedData(result.formData || result);\n    setConfidenceScores(result.confidenceScores);\n    setPageState('form');\n  };\n\n  const handleProcessingCancel = () => {\n    setPageState('recording');\n    setAudioBlob(null);\n    setExtractedData(null);\n    setConfidenceScores(null);\n  };\n\n  const handleFormSubmit = async (formData: any) => {\n    setSaving(true);\n    try {\n      const { user } = useAuth();\n      if (!user) {\n        throw new Error('User not authenticated');\n      }\n\n      // Save to Firebase via API endpoint\n      const response = await api.createInventoryItem({\n        ...formData,\n        created_by: user.uid\n      });\n\n      if (!response.success) {\n        throw new Error(response.error || 'Failed to save equipment');\n      }\n\n      console.log('Equipment saved successfully:', response.data);\n      \n      // Navigate to inventory page after successful save\n      navigate('/inventory');\n    } catch (error) {\n      console.error('Error saving equipment:', error);\n      alert('Failed to save equipment. Please try again.');\n    } finally {\n      setSaving(false);\n    }\n  };\n\n  const handleFormCancel = () => {\n    setPageState('recording');\n    setAudioBlob(null);\n    setExtractedData(null);\n    setConfidenceScores(null);\n  };\n\n  if (pageState === 'form') {\n    console.log('Rendering form with data:', extractedData, 'confidence:', confidenceScores);\n    return (\n      <div className=\"p-6\">\n        <div className=\"text-center mb-8\">\n          <h2 className=\"font-heading font-bold text-primary text-2xl mb-2\">\n            Review & Save Equipment\n          </h2>\n          <p className=\"text-gray-medium\">\n            Verify details and add to digital inventory\n          </p>\n        </div>\n\n        <EquipmentForm\n          initialData={extractedData}\n          confidenceScores={confidenceScores}\n          onSubmit={handleFormSubmit}\n          onCancel={handleFormCancel}\n          loading={saving}\n        />\n      </div>\n    );\n  }\n\n  return (\n    <>\n      <div style={{padding: '0', minHeight: '400px'}}>\n        <div style={{textAlign: 'center', marginBottom: '40px'}}>\n          <h2 style={{\n            fontSize: '28px',\n            fontWeight: '700',\n            color: '#1f2937',\n            marginBottom: '12px',\n            lineHeight: '1.2'\n          }}>\n            Add New Item\n          </h2>\n          <p style={{\n            color: '#6b7280',\n            fontSize: '16px',\n            lineHeight: '1.5',\n            margin: '0 0 20px 0'\n          }}>\n            Record equipment details to add to your inventory\n          </p>\n          \n          {/* Sample Text Button */}\n          <button\n            onClick={() => {\n              const sampleText = \"This is a Canon camera, the R5 model I think. Got it from some dealer last year. Condition looks good, working fine but has some scratches on the body. Don't know the exact serial number... will check later. We keep it somewhere in the back warehouse. Pretty expensive camera, should rent for good money.\";\n              console.log('Using sample text:', sampleText);\n              \n              // Create a mock audio blob with the sample text\n              const blob = new Blob([sampleText], { type: 'audio/webm' });\n              setAudioBlob(blob);\n              setPageState('processing');\n            }}\n            style={{\n              backgroundColor: '#f3f4f6',\n              border: '1px solid #d1d5db',\n              borderRadius: '8px',\n              padding: '8px 16px',\n              fontSize: '14px',\n              color: '#374151',\n              cursor: 'pointer',\n              marginBottom: '20px'\n            }}\n          >\n            🧪 Use Sample Data (for testing)\n          </button>\n\n          {/* Speaking Prompts */}\n          <div style={{textAlign: 'left', marginBottom: '20px'}}>\n            <p style={{fontSize: '14px', fontWeight: '600', color: '#374151', marginBottom: '8px'}}>\n              💡 What to mention when recording:\n            </p>\n            <div style={{display: 'flex', flexWrap: 'wrap', gap: '8px', justifyContent: 'center'}}>\n              {[\n                'Equipment name & brand',\n                'Model number', \n                'Serial number',\n                'Condition',\n                'Purchase price',\n                'Current value',\n                'Daily rate',\n                'Storage location',\n                'Any issues or notes'\n              ].map((prompt, index) => (\n                <span key={index} style={{\n                  backgroundColor: '#fef3c7',\n                  color: '#92400e',\n                  padding: '4px 8px',\n                  borderRadius: '12px',\n                  fontSize: '12px',\n                  border: '1px solid #fbbf24'\n                }}>\n                  {prompt}\n                </span>\n              ))}\n            </div>\n          </div>\n        </div>\n\n        <div style={{\n          backgroundColor: '#f8fafc',\n          borderRadius: '24px',\n          padding: '32px 24px',\n          boxShadow: '0 4px 24px rgba(0, 0, 0, 0.06)',\n          border: '1px solid #e2e8f0'\n        }}>\n          <VoiceRecorder\n            onRecordingComplete={handleRecordingComplete}\n            onCancel={() => navigate('/inventory')}\n          />\n        </div>\n      </div>\n\n      <ProcessingModal\n        isOpen={pageState === 'processing'}\n        onCancel={handleProcessingCancel}\n        onComplete={handleProcessingComplete}\n        audioBlob={audioBlob}\n      />\n    </>\n  );\n};\n\nexport default AddItemPage;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}